<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<project default="create signed IAP-jar" name="Create Runnable Jar for IAP Cloud Computing">
    <!--ANT 1.7 is required -->
    <target name="create signed IAP-jar">
    	<!-- create vanted-jarfile -->
        <jar destfile="vanted_with_doublettes.jar" filesetmanifest="mergewithoutmain">
            <fileset dir="../IAP/bin"/>
            <fileset dir="../Graffiti_Core/build/classes"/>
            <zipfileset excludes="META-INF/*.SF" src="../Graffiti_lib/commons-beanutils.jar"/>
            <zipfileset excludes="META-INF/*.SF" src="../Graffiti_lib/commons-digester.jar"/>
            <zipfileset excludes="META-INF/*.SF" src="../Graffiti_lib/jdom.jar"/>
            <zipfileset excludes="META-INF/*.SF" src="../Graffiti_lib/java-cup-v11a-runtime.jar"/>
            <zipfileset excludes="META-INF/*.SF" src="../Graffiti_lib/jh.jar"/>
            <zipfileset excludes="META-INF/*.SF" src="../Graffiti_lib/log4j-1.2.13.jar"/>
            <zipfileset excludes="META-INF/*.SF" src="../Graffiti_lib/commons-logging-1.1.jar"/>
            <zipfileset excludes="META-INF/*.SF" src="../Graffiti_lib/commons-collections-3.1.jar"/>
            <zipfileset excludes="META-INF/*.SF" src="../Graffiti_lib/activation.jar"/>
            <zipfileset excludes="META-INF/*.SF" src="../Graffiti_lib/axis.jar"/>
            <zipfileset excludes="META-INF/*.SF" src="../Graffiti_lib/batik-awt-util.jar"/>
            <zipfileset excludes="META-INF/*.SF" src="../Graffiti_lib/batik-bridge.jar"/>
            <zipfileset excludes="META-INF/*.SF" src="../Graffiti_lib/batik-css.jar"/>
            <zipfileset excludes="META-INF/*.SF" src="../Graffiti_lib/batik-dom.jar"/>
            <zipfileset excludes="META-INF/*.SF" src="../Graffiti_lib/batik-ext.jar"/>
            <zipfileset excludes="META-INF/*.SF" src="../Graffiti_lib/batik-gvt.jar"/>
            <zipfileset excludes="META-INF/*.SF" src="../Graffiti_lib/batik-parser.jar"/>
            <zipfileset excludes="META-INF/*.SF" src="../Graffiti_lib/batik-rasterizer.jar"/>
            <zipfileset excludes="META-INF/*.SF" src="../Graffiti_lib/batik-script.jar"/>
            <zipfileset excludes="META-INF/*.SF" src="../Graffiti_lib/batik-svg-dom.jar"/>
            <zipfileset excludes="META-INF/*.SF" src="../Graffiti_lib/batik-svggen.jar"/>
            <zipfileset excludes="META-INF/*.SF" src="../Graffiti_lib/batik-transcoder.jar"/>
            <zipfileset excludes="META-INF/*.SF" src="../Graffiti_lib/batik-util.jar"/>
            <zipfileset excludes="META-INF/*.SF" src="../Graffiti_lib/batik-xml.jar"/>
            <zipfileset excludes="META-INF/*.SF" src="../Graffiti_lib/bsh-2.0b4.jar"/>
            <zipfileset excludes="META-INF/*.SF" src="../Graffiti_lib/commons-cli-1.0.jar"/>
            <zipfileset excludes="META-INF/*.SF" src="../Graffiti_lib/commons-discovery.jar"/>
<!--            <zipfileset excludes="META-INF/*.SF" src="../Graffiti_lib/commons-math-1.0.jar"/> -->
            <zipfileset excludes="META-INF/*.SF" src="../Graffiti_lib/dom4j-1.6.1.jar"/>
            <zipfileset excludes="META-INF/*.SF" src="../Graffiti_lib/itext-1.4.5.jar"/>
            <zipfileset excludes="META-INF/*.SF" src="../Graffiti_lib/jaxen-full.jar"/>
            <zipfileset excludes="META-INF/*.SF" src="../Graffiti_lib/jaxrpc.jar"/>
            <zipfileset excludes="META-INF/*.SF" src="../Graffiti_lib/jcommon-0.9.5.jar"/>
            <zipfileset excludes="META-INF/*.SF" src="../Graffiti_lib/jruby.jar"/>
            <zipfileset excludes="META-INF/*.SF" src="../Graffiti_lib/keggapi.jar"/>
            <zipfileset excludes="META-INF/*.SF" src="../Graffiti_lib/mail.jar"/>
            <zipfileset excludes="META-INF/*.SF" src="../Graffiti_lib/parser.jar"/>
            <zipfileset excludes="META-INF/*.SF" src="../Graffiti_lib/optional.jar"/>
            <zipfileset excludes="META-INF/*.SF" src="../Graffiti_lib/pdf-transcoder.jar"/>
            <zipfileset excludes="META-INF/*.SF" src="../Graffiti_lib/rome-0.8.jar"/>
            <zipfileset excludes="META-INF/*.SF" src="../Graffiti_lib/saaj.jar"/>
            <zipfileset excludes="META-INF/*.SF" src="../Graffiti_lib/saxpath.jar"/>
            <zipfileset excludes="META-INF/*.SF" src="../Graffiti_lib/secondstring-20030401.jar"/>
            <zipfileset excludes="META-INF/*.SF" src="../Graffiti_lib/soap.jar"/>
            <zipfileset excludes="META-INF/*.SF" src="../Graffiti_lib/vecmath1.2-1.14.jar"/>
            <zipfileset excludes="META-INF/*.SF" src="../Graffiti_lib/wsdl4j.jar"/>
            <zipfileset excludes="META-INF/*.SF" src="../Graffiti_lib/xercesImpl.jar"/>
            <zipfileset excludes="META-INF/*.SF" src="../Graffiti_lib/xmlParserAPIs.jar"/>
<!--            <zipfileset excludes="META-INF/*.SF" src="/Users/klukas/Applications/eclipse/plugins/org.junit4_4.5.0.v20090824/junit.jar"/> -->
<!--            <zipfileset excludes="META-INF/*.SF" src="/Users/klukas/Applications/eclipse/plugins/org.hamcrest.core_1.1.0.v20090501071000.jar"/> -->
            <fileset dir="../Graffiti_Editor/build/classes"/>
            <fileset dir="../Graffiti_Plugins/build/classes"/>
            <zipfileset excludes="META-INF/*.SF" src="../Graffiti_lib/jlex_java_cup.jar"/>
            <fileset dir="../IPK-Plugins/build/classes"/>
            <fileset dir="../IPK_lib/build"/>
<!--            <zipfileset excludes="META-INF/*.SF" src="../IPK_lib/OfficeLnFs_2.7.jar"/> -->
            <zipfileset excludes="META-INF/*.SF" src="../IAP/lib/ojdbc14.jar"/>
<!--            <zipfileset excludes="META-INF/*.SF" src="../Graffiti_lib/oraclexsql.jar"/> -->
<!--            <zipfileset excludes="META-INF/*.SF" src="../Graffiti_lib/xdb.jar"/> -->
            <zipfileset excludes="META-INF/*.SF" src="../Graffiti_lib/commons-net-2.0.jar"/>
            <zipfileset excludes="META-INF/*.SF" src="../Graffiti_lib/commons-net-ftp-2.0.jar"/>
            <zipfileset excludes="META-INF/*.SF" src="../IAP/lib/plugin.jar"/>
            <fileset dir="../MultimodalDataHandling/bin"/>
            <zipfileset excludes="META-INF/*.SF" src="../MultimodalDataHandling/lib/pixelmed.jar"/>
            <zipfileset excludes="META-INF/*.SF" src="../MultimodalDataHandling/lib/jcommon1.0.16.jar"/>
            <zipfileset excludes="META-INF/*.SF" src="../MultimodalDataHandling/lib/jfreechart1.0.13.jar"/>
<!--            <fileset dir="../Hive Add-on/build/classes"/> -->
<!--            <zipfileset excludes="META-INF/*.SF" src="../Hive Add-on/lib/myswing.jar"/> -->
<!--            <zipfileset excludes="META-INF/*.SF" src="../Hive Add-on/lib/AnaglyphCanvas3Dlib.jar"/> -->
            <zipfileset excludes="META-INF/*.SF" src="../IAP/lib/j3dcore.jar"/>
            <zipfileset excludes="META-INF/*.SF" src="../IAP/lib/j3dutils.jar"/>
            <zipfileset excludes="META-INF/*.SF" src="../IAP/lib/vecmath.jar"/>
            <zipfileset excludes="META-INF/*.SF" src="../Hive Add-on/lib/swingx.jar"/>
            <zipfileset excludes="META-INF/*.SF" src="../IAP/lib/postgresql-9.0-801.jdbc4.jar"/>
            <zipfileset excludes="META-INF/*.SF" src="../IAP/lib/mongo-2.5.jar"/>
            <zipfileset excludes="META-INF/*.SF" src="../IAP/lib/jai_codec.jar"/>
            <zipfileset excludes="META-INF/*.SF" src="../IAP/lib/jai_core.jar"/>
            <zipfileset excludes="META-INF/*.SF" src="../IAP/lib/commons-compress-1.1.jar"/>
            <manifest>
                <attribute name="Built-By" value="${user.name}"/>
                <attribute name="Main-Class" value="de.ipk.ag_ba.server.task_management.CloudComputingService"/>
                <attribute name="Class-Path" value="."/>
            </manifest>
        </jar>
    	<!-- get rid of double-entries like "license.txt" because of signing -->
    	<unzip src="vanted_with_doublettes.jar" dest="vanted_temp" />
    	<delete file="vanted_with_doublettes.jar"/>
    	<zip destfile="vanted_without_doublettes.jar" basedir="vanted_temp" />
        <delete dir="vanted_temp"/>
    	<!-- sign jarfile for webstart -->
	<copy file="vanted_without_doublettes.jar" tofile="release/iap.jar"/>
<!--        <signjar jar="vanted_without_doublettes.jar" signedjar="release/iap.jar" keystore="ant-scripts/pbikeystore" alias="ipk_pbi" storepass="253f7d26709117ff8f28f95666de1e72"/> -->
    	<delete file="vanted_without_doublettes.jar"/>
    </target>
</project>
